<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="machine learning,">










<meta name="description" content="线性模型 – Generalize Linear Models 所谓的GLMs是一类机器学习算法，其中最小二乘线性回归（LMS）以及逻辑回归（LR）都是GLMs的一个特例。 线性模型的特性  指数分布族 – The exponential family 所有GLMs的分布律都可以写成如下的指数分布族：\(p(y;\eta) = b(y)exp(\eta^TT(y) - a(\eta))\) 其中\">
<meta name="keywords" content="machine learning">
<meta property="og:type" content="article">
<meta property="og:title" content="General Linear Model">
<meta property="og:url" content="http://yoursite.com/2017/10/20/General-Linear-Model/index.html">
<meta property="og:site_name" content="Super FF&#39; Blogs">
<meta property="og:description" content="线性模型 – Generalize Linear Models 所谓的GLMs是一类机器学习算法，其中最小二乘线性回归（LMS）以及逻辑回归（LR）都是GLMs的一个特例。 线性模型的特性  指数分布族 – The exponential family 所有GLMs的分布律都可以写成如下的指数分布族：\(p(y;\eta) = b(y)exp(\eta^TT(y) - a(\eta))\) 其中\">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-10-21T03:53:55.158Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="General Linear Model">
<meta name="twitter:description" content="线性模型 – Generalize Linear Models 所谓的GLMs是一类机器学习算法，其中最小二乘线性回归（LMS）以及逻辑回归（LR）都是GLMs的一个特例。 线性模型的特性  指数分布族 – The exponential family 所有GLMs的分布律都可以写成如下的指数分布族：\(p(y;\eta) = b(y)exp(\eta^TT(y) - a(\eta))\) 其中\">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/10/20/General-Linear-Model/">





  <title>General Linear Model | Super FF' Blogs</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Super FF' Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">STAY HUNGRY. STAY FOOLISH</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/20/General-Linear-Model/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frankie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Super FF' Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">General Linear Model</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-20T15:04:23+08:00">
                2017-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/study/" itemprop="url" rel="index">
                    <span itemprop="name">study</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="线性模型-generalize-linear-models">线性模型 – Generalize Linear Models</h1>
<p>所谓的GLMs是一类机器学习算法，其中最小二乘线性回归（LMS）以及逻辑回归（LR）都是GLMs的一个特例。</p>
<h2 id="线性模型的特性">线性模型的特性</h2>
<ol type="1">
<li><h3 id="指数分布族-the-exponential-family">指数分布族 – The exponential family</h3>
<p>所有GLMs的分布律都可以写成如下的指数分布族：<span class="math inline">\(p(y;\eta) = b(y)exp(\eta^TT(y) - a(\eta))\)</span></p>
<p>其中<span class="math inline">\(\eta\)</span>被称为自然参数或者规范参数， <span class="math inline">\(T(y)\)</span> 被称为充分统计量，<span class="math inline">\(a(\eta)\)</span> 是对数分量函数。</p></li>
<li><h3 id="构建glm的假设条件">构建GLM的假设条件</h3>
<ul>
<li><p><span class="math inline">\(y|x;\theta \sim ExponetialFamily(\eta)\)</span></p></li>
<li><p>给定<span class="math inline">\(x\)</span>，我们的目标是预测<span class="math inline">\(T(y)\)</span>的期望值。即希望通过假设函数 <span class="math display">\[
h_{\theta}(x)
\]</span> 预测的结果满足 <span class="math display">\[
h_\theta(x) = E[T(y)|x]
\]</span></p></li>
<li><p>自然参数<span class="math inline">\(\eta\)</span> 与 <span class="math inline">\(x\)</span> 线性相关，即<span class="math inline">\(\eta = \theta^Tx\)</span></p></li>
</ul></li>
</ol>
<h2 id="线性模型实例">线性模型实例</h2>
<p>下面我们介绍一些线性模型的实例，比如我们常见的线性回归，逻辑回归以及Softmax回归多分类器。</p>
<ol type="1">
<li><h3 id="线性回归">线性回归</h3>
<p>线性回归是一种进行连续值预测的常用方法。假设有<span class="math inline">\(m\)</span>个样本,每个样本包含<span class="math inline">\(n\)</span>个特征，即<span class="math inline">\(X\in R^{m,n}\)</span>，那么回归预测的问题可以描述成 <span class="math display">\[
y^{(i)} = \theta^T * x^{(i)} + \epsilon^{(i)}
\]</span> 其中<span class="math inline">\(\theta\)</span>为待拟合的线性模型的权重，<span class="math inline">\(\epsilon(i)\)</span>为拟合误差。</p>
<p>假设各个样本的拟合误差独立同分布于（IID）正态分布，即<span class="math inline">\(\epsilon^{(i)} \sim N(\mu,\delta^2)\)</span> . 假设<span class="math inline">\(\mu = 0\)</span>(可以通过正则化来达到)，那么 <span class="math display">\[
p(\epsilon^i) = \frac{1}{\sqrt{2\pi}\delta}\exp{-\frac{(\epsilon^{(i)})^2}{2\delta^2}}
\]</span></p>
<p><span class="math display">\[
p(y^{(i)} | x^{(i)},\theta) = \frac{1}{\sqrt{2\pi}\delta}\exp{-\frac{(y^{(i)} - \theta^T*x^{(i)})^2}{2\delta^2}}
\]</span></p>
<p>那么，该分布的似然函数为: <span class="math display">\[
L(\theta) = \prod_{i=1}^m p(y^{(i)} | x^{(i)},\theta)
\]</span></p>
<p><span class="math display">\[
\log{L(\theta)} = \sum_{i=1}^m p(y^{(i)} | x^{(i)},\theta) = -m\log{\sqrt{2\pi}\delta} - \sum_{i=1}^m \frac{(y^{(i)} - \theta^Tx^{(i)})^2}{2\delta^2}
\]</span></p>
<p>为了使得线性模型能够得到较好的拟合效果,即最大似然估计: <span class="math display">\[
\max{(\log{L(\theta)})}
\]</span> 结合上式，即 <span class="math display">\[
\min{(\sum_{i=1}^m (y^{(i)} - \theta^Tx^{(i)})^2)}
\]</span> 其中无论<span class="math inline">\(\delta\)</span>如何取值都与问题求解无关。 那么最终的拟合过程，变成了最小二乘问题。</p></li>
<li><h3 id="逻辑回归">逻辑回归</h3>
<p>逻辑回归是一种二分类问题，假设给你m个样本，每个样本<span class="math inline">\(n\)</span>个特征，并且所有样本有两个类别，假设是{0,1}。假设样本服从二项分布，即 <span class="math display">\[
p(y=1|\phi) = \phi, p(y=0|\phi) = 1- \phi
\]</span> 那么 <span class="math display">\[
p(y|\phi) = \phi^y(1-\phi)^{1-y}
\]</span></p>
<p><span class="math display">\[
p(y|\phi) = \exp{(y\log{\phi} + (1-y)\log{(1-\phi)})}
\]</span></p>
<p><span class="math display">\[
p(y|\phi) = \exp{(y\log{\frac{\phi}{1-\phi}} + \log{(1-\phi)})}
\]</span></p>
<p>构建GLM得到： <span class="math display">\[
T(y) = y, b(y) = 1, \eta = \log{\frac{\phi}{1-\phi}}, \phi = \frac{1}{1+e^{\eta}}, a(\eta) = \log{(1+e^{\eta})}
\]</span> 又 <span class="math display">\[
\eta^{(i)} = \theta^T * x^{(i)}
\]</span> 所以 <span class="math display">\[
\phi^{(i)} = \frac{1}{1+e^{-(\theta^T x^{(i)})}}
\]</span> 同时，为了求解拟合参数<span class="math inline">\(\theta\)</span>.参考线性回归的求解过程：</p>
<ul>
<li><p>求解似然函数：<span class="math inline">\(L(\theta) = \prod_{i=1}^{m}((\phi^{(i)})^{y^{(i)}} (1-\phi^{(i)})^{(1-y^{(i)})})\)</span></p></li>
<li><p>对似然函数变形：<span class="math inline">\(l(\theta) = \log{L(\theta)} = \sum_{i=1}^{m}(y^{(i)}\log{\phi^{(i)}}+(1-y^{(i)})\log{(1-\phi^{(i)})})\)</span></p></li>
<li><p>求解变形后的似然函数的最大值，梯度下降求解。每一步迭代的梯度为： <span class="math display">\[
\frac{\partial{(l(\theta))}}{\partial{\theta_j}} = (y\frac{1}{\phi} + (1-y)\frac{1}{1-\phi}) \phi(1-\phi)x_j
\]</span></p>
<p><span class="math display">\[
\frac{\partial{(l(\theta))}}{\partial{\theta_j}} = (y - \phi)x_{j}
\]</span></p></li>
</ul></li>
<li><h3 id="softmax回归">Softmax回归</h3>
<p>Softmax Regression主要用于解决多分类问题，假设 <span class="math display">\[
y\in \{1,2,3,…,k\}
\]</span> 用于表示样本的类别。</p>
<p><span class="math inline">\(\phi_i\)</span> 表示样本属于第<span class="math inline">\(i\)</span>类的概率，即<span class="math inline">\(p(y=i;\phi) = \phi_i\)</span></p>
<p>由于<span class="math inline">\(\sum_{i=1}^{k}\phi_i = 1\)</span>, 所以可以令<span class="math inline">\(\phi_{k} = 1-\sum_{i=1}^{k-1}\phi_i\)</span></p>
<p>为了使得多项分布能够用指数函数族描述，在此引入<span class="math inline">\(T(y)\)</span>,其中 <span class="math display">\[
T(1) = \left(\begin{array}{c} 1 \\ 0 \\ 0 \\ \vdots \\ 0 \end{array} \right), T(2) = \left(\begin{array}{c} 0 \\ 1 \\ 0 \\ \vdots \\ 0 \end{array} \right), \ldots, T(k-1) = \left(\begin{array}{c} 0 \\ 0 \\ 0 \\ \vdots \\ 1 \end{array} \right), T(k) = \left(\begin{array}{c} 0 \\ 0 \\ 0 \\ \vdots \\ 0 \end{array} \right)
\]</span> 那么<span class="math inline">\(T(y) \neq y, T(y) \in R^{k-1}\)</span>。且<span class="math inline">\((T(y))_i = 1\{y=i\}\)</span> ，其中<span class="math inline">\(1\{.\}=1\)</span> when · is true.</p>
<p>那么<span class="math inline">\(E[(T(y))_i] = p(y=i) = \phi_i\)</span> <span class="math display">\[
p(y;\phi) = \phi_1^{1\{y=1\}}\phi_2^{1\{y=2\}}\ldots\phi_k^{1\{y=k\}}
\]</span></p>
<p><span class="math display">\[
p(y;\phi) = \exp({1\{y=1\}}\log\{\phi_1\}+\ldots+{1\{y=k\}}\log\{\phi_k\})
\]</span></p>
<p><span class="math display">\[
p(y;\phi) = \exp({1\{y=1\}}\log\{\phi_1\}+\ldots+(1-\sum_{i=1}^{k-1}{1\{y=i\}})\log\{\phi_k\})
\]</span></p>
<p><span class="math display">\[
p(y;\phi) = \exp(\sum_{i=1}^{k-1}{1\{y=i\}}\log\{\phi_i\}+\ldots+(1-\sum_{i=1}^{k-1}{1\{y=i\}})\log\{\phi_k\})
\]</span></p>
<p><span class="math display">\[
p(y;\phi) = \exp(\sum_{i=1}^{k-1}{1\{y=i\}}\log\{\phi_i/\phi_k\}+\ldots+\log{\phi_k})
\]</span></p>
<p><span class="math display">\[
p(y;\phi) = \exp(\sum_{i=1}^{k-1}{(T(y))_i}\log\{\phi_i/\phi_k\}+\ldots+\log{\phi_k})
\]</span></p>
<p><span class="math display">\[
p(y;\eta) = b(y)exp(\eta^TT(y) - a(\eta))
\]</span></p>
<p>得到$b(y)=1, = (\begin{array}{c} (_1/_k) \ (_2/_k) \ (_3/<em>k) \ \ (</em>{k-1}/_k) \end{array} ) <span class="math inline">\(, 其中\)</span>a() = -(_k)$</p>
<p>link function(<span class="math inline">\(\eta\)</span>为分布律的函数)：<span class="math inline">\(\eta_i = \log(\phi_i/\phi_k)\)</span></p>
<p>response function(分布律为<span class="math inline">\(\eta\)</span>的函数，也称为softmax函数)：<span class="math inline">\(\phi_i = e^{\eta_i}/\sum_{j=1}^k{e^{\eta_j}}\)</span></p>
<p>又：<span class="math inline">\(\eta_i=\theta_i^Tx\)</span></p>
<p>得：<span class="math inline">\(\phi_i = \exp(\theta_i^Tx)/\sum_{j=1}^k{\exp(\theta_j^Tx)}\)</span></p>
<p>那么假设函数： <span class="math display">\[
h_{\theta}(x) = E[T(y)|x;\theta] = \left(\begin{array}{c} \phi_1 \\ \phi_2 \\ \phi_3 \\ \vdots \\ \phi_{k-1} \end{array} \right) = \left(\begin{array}{c} \frac{\exp(\theta_1^Tx)}{\sum_{j=1}^k{\exp(\theta_j^Tx)}} \\ \frac{\exp(\theta_2^Tx)}{\sum_{j=1}^k{\exp(\theta_j^Tx)}} \\ \frac{\exp(\theta_3^Tx)}{\sum_{j=1}^k{\exp(\theta_j^Tx)}} \\ \vdots \\ \frac{\exp(\theta_{k-1}^Tx)}{\sum_{j=1}^k{\exp(\theta_j^Tx)}} \end{array} \right)
\]</span> 似然函数为： <span class="math display">\[
l(\theta) = \sum_{i=1}^{m}\log(p(y^{(i)}|x^{(i)};\theta)) = \sum_{i=1}^{m}\prod_{l=1}^k(\frac{\exp(\theta_l^Tx^{(i)})}{\sum_{j=1}^k{\exp(\theta_j^Tx^{(i)})}})^{1\{y^{(i)}=l\}}
\]</span> 最终求解该似然函数的最优解可以得到整个模型的最优解及其对应的模型。</p></li>
</ol>
<h1 id="step-by-step-to-fulfill-softmax-classification-for-mnist-dataset">Step by Step to fulfill softmax classification for MNIST dataset</h1>
<h2 id="step1-load-sample-data-set">Step1: Load sample data set</h2>
<p>加载MNIST样本数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from tensorflow.examples.tutorials.mnist import input_data</span><br><span class="line">mnist = input_data.read_data_sets(&quot;MNIST_data/&quot;, one_hot=True)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：在执行上述代码时如果遇到file not gzip file错误，是由于下载的数据有问题。去修改源文件[Where tensorflow located]/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/datasets/mnist.py, 将SOURCE_URL换成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; SOURCE_URL = &apos;http://yann.lecun.com/exdb/mnist/&apos;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="step2-construct-glmsoftmax">Step2: Construct GLM(Softmax)</h2>
<p>构造假设函数（Softmax分类模型）：<span class="math inline">\(y = h_{\theta}(x) = softmax(W*x + b)\)</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import tensorflow as tf</span><br><span class="line">x = tf.placeholder(tf.float32, [None, 784])</span><br><span class="line">W = tf.Variable(tf.zeros([784, 10]))</span><br><span class="line">b = tf.Variable(tf.zeros([10]))</span><br><span class="line">y = tf.nn.softmax(tf.matmul(x, W) + b)</span><br></pre></td></tr></table></figure>
<h2 id="step3-train-glmsoftmax">Step3: Train GLM(Softmax)</h2>
<p>求解假设函数的最优值，构造最优化问题目标函数：<span class="math inline">\(H_{y_i^{‘}}(y) = H_{y_i^{‘}}(h_{\theta(x^{(i)}})\)</span></p>
<p>在此使用交叉熵作为目标函数，即：<span class="math inline">\(H_{y_i^{‘}}(y) = -\sum_i(y_i^{‘})\log(h_{\theta(x^{(i)})})\)</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_ = tf.placeholder(tf.float32, [None, 10])</span><br><span class="line">cross_entropy = tf.reduce_mean(-tf.reduce_sum(y_ * tf.log(y), reduction_indices=[1]))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>亦可以直接使用tensorflow提供的函数计算cross_entropy = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=y_, logits=y))<code>其中</code>y=W*x+b</p>
</blockquote>
<p>定义优化方法（梯度下降）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_step = tf.train.GradientDescentOptimizer(0.5).minimize(cross_entropy)</span><br></pre></td></tr></table></figure>
<p>Tensorflow执行优化过程（随机梯度下降）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">tf.global_variables_initializer().run()</span><br><span class="line">for _ in range(1000):</span><br><span class="line">  batch_xs, batch_ys = mnist.train.next_batch(100)</span><br><span class="line">  sess.run(train_step, feed_dict=&#123;x: batch_xs, y_: batch_ys&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="step-4-模型评估">Step 4: 模型评估</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">correct_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1))</span><br><span class="line">accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))</span><br><span class="line">print(sess.run(accuracy, feed_dict=&#123;x: mnist.test.images, y_: mnist.test.labels&#125;))</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/machine-learning/" rel="tag"># machine learning</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/10/Linear-Regression/" rel="prev" title="Linear Regression">
                Linear Regression <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Frankie</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#线性模型-generalize-linear-models"><span class="nav-number">1.</span> <span class="nav-text">线性模型 – Generalize Linear Models</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#线性模型的特性"><span class="nav-number">1.1.</span> <span class="nav-text">线性模型的特性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#指数分布族-the-exponential-family"><span class="nav-number">1.1.1.</span> <span class="nav-text">指数分布族 – The exponential family</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构建glm的假设条件"><span class="nav-number">1.1.2.</span> <span class="nav-text">构建GLM的假设条件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性模型实例"><span class="nav-number">1.2.</span> <span class="nav-text">线性模型实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#线性回归"><span class="nav-number">1.2.1.</span> <span class="nav-text">线性回归</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逻辑回归"><span class="nav-number">1.2.2.</span> <span class="nav-text">逻辑回归</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#softmax回归"><span class="nav-number">1.2.3.</span> <span class="nav-text">Softmax回归</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#step-by-step-to-fulfill-softmax-classification-for-mnist-dataset"><span class="nav-number">2.</span> <span class="nav-text">Step by Step to fulfill softmax classification for MNIST dataset</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#step1-load-sample-data-set"><span class="nav-number">2.1.</span> <span class="nav-text">Step1: Load sample data set</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#step2-construct-glmsoftmax"><span class="nav-number">2.2.</span> <span class="nav-text">Step2: Construct GLM(Softmax)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#step3-train-glmsoftmax"><span class="nav-number">2.3.</span> <span class="nav-text">Step3: Train GLM(Softmax)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#step-4-模型评估"><span class="nav-number">2.4.</span> <span class="nav-text">Step 4: 模型评估</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Frankie</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
